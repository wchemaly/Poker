<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Card Counting Trainer</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    #container { max-width: 400px; margin: auto; }
    .hidden { display: none; }
    .card { font-size: 2em; margin: 5px; }
    #flash { animation: flash 0.5s infinite alternate; }
    @keyframes flash { from { background: white; } to { background: #eee; } }
  </style>
</head>
<body>
  <div id="container">
    <select id="levelSelect">
      <option value="1">Level 1</option>
      <option value="2">Level 2</option>
      <option value="3">Level 3</option>
      <option value="4">Level 4</option>
      <option value="5">Level 5</option>
      <option value="6">Level 6</option>
      <option value="7">Level 7</option>
    </select>
    <button id="startBtn">Start</button>

    <div id="level1" class="hidden">
      <div id="card1" class="card"></div>
      <input id="input1" placeholder="Count value" />
      <button onclick="check1()">Submit</button>
      <div id="fb1"></div>
    </div>

    <div id="level2" class="hidden">
      <div id="cards2"></div>
      <input id="input2" placeholder="Net count" />
      <button onclick="check2()">Submit</button>
      <div id="fb2"></div>
    </div>

    <div id="level3" class="hidden">
      <div id="cards3"></div>
      <input id="input3" placeholder="Final count" />
      <button onclick="check3()">Submit</button>
      <div id="fb3"></div>
    </div>

    <div id="level4" class="hidden">
      <div id="timer4">Time: 0s</div>
      <div id="cards4"></div>
      <input id="input4" placeholder="Final count" />
      <button onclick="check4()">Submit</button>
      <div id="fb4"></div>
    </div>

    <div id="level5" class="hidden">
      <div id="info5"></div>
      <input id="input5" placeholder="True count" />
      <button onclick="check5()">Submit</button>
      <div id="fb5"></div>
    </div>

    <div id="level6" class="hidden">
      <div id="info6"></div>
      <input id="input6" placeholder="Action" />
      <button onclick="check6()">Submit</button>
      <div id="fb6"></div>
    </div>

    <div id="level7" class="hidden">
      <div id="timer7">Time: 0s</div>
      <div id="cards7"></div>
      <input id="input7" placeholder="Final count" />
      <button onclick="check7()">Submit</button>
      <div id="fb7"></div>
    </div>
  </div>

  <script>
    const values = { '2':1,'3':1,'4':1,'5':1,'6':1,'7':0,'8':0,'9':0,'10':-1,'J':-1,'Q':-1,'K':-1,'A':-1 };
    const ranks = Object.keys(values);

    function randCard() { return ranks[Math.floor(Math.random()*ranks.length)]; }
    function shuffle(arr) { for(let i=arr.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];} return arr; }

    document.getElementById('startBtn').onclick = ()=>{
      const lvl = document.getElementById('levelSelect').value;
      for(let i=1;i<=7;i++) document.getElementById('level'+i).classList.add('hidden');
      window['setup'+lvl]();
      document.getElementById('level'+lvl).classList.remove('hidden');
    };

    // Level 1
    function setup1(){ next1(); }
    function next1(){ window.card1 = randCard(); document.getElementById('card1').textContent=card1; document.getElementById('input1').value=''; document.getElementById('fb1').textContent=''; }
    function check1(){ const ans=values[window.card1]; const inp=Number(document.getElementById('input1').value); document.getElementById('fb1').textContent = (inp===ans?'Correct':'Wrong'); next1(); }

    // Level 2
    function setup2(){ window.cards2=[]; let n=2+Math.floor(Math.random()*5); while(window.cards2.length<n) window.cards2.push(randCard()); document.getElementById('cards2').textContent=window.cards2.join(' '); document.getElementById('input2').value=''; document.getElementById('fb2').textContent=''; }
    function check2(){ const sum=window.cards2.reduce((s,c)=>s+values[c],0); const inp=Number(document.getElementById('input2').value); document.getElementById('fb2').textContent=(inp===sum?'Correct':'Wrong'); setup2(); }

    // Level 3
    function setup3(){ window.cards3=[]; let n=10+Math.floor(Math.random()*11); while(window.cards3.length<n) window.cards3.push(randCard()); document.getElementById('cards3').textContent=window.cards3.join(' '); document.getElementById('input3').value=''; document.getElementById('fb3').textContent=''; }
    function check3(){ const sum=window.cards3.reduce((s,c)=>s+values[c],0); const inp=Number(document.getElementById('input3').value); document.getElementById('fb3').textContent=(inp===sum?'Correct':'Wrong'); setup3(); }

    // Level 4
    function setup4(){ window.start4=Date.now(); const deck=ranks.flatMap(r=>['♠','♥','♦','♣'].map(s=>r)); shuffle(deck); window.cards4=deck; document.getElementById('cards4').textContent=deck.join(' '); document.getElementById('timer4').textContent='Time: 0s'; document.getElementById('input4').value=''; document.getElementById('fb4').textContent=''; window.timerInt4=setInterval(()=>{ let t=Math.floor((Date.now()-window.start4)/1000); document.getElementById('timer4').textContent='Time: '+t+'s'; },200); }
    function check4(){ clearInterval(window.timerInt4); const sum=window.cards4.reduce((s,c)=>s+values[c],0); const inp=Number(document.getElementById('input4').value); document.getElementById('fb4').textContent=(inp===sum?'Correct':'Wrong'); }

    // Level 5
    function setup5(){ window.running5=Math.floor(Math.random()*41)-20; window.decks5=(Math.random()*5+0.1).toFixed(1); document.getElementById('info5').textContent=`Running count: ${window.running5}, Decks left: ${window.decks5}`; document.getElementById('input5').value=''; document.getElementById('fb5').textContent=''; }
    function check5(){ const trueCount=(window.running5/parseFloat(window.decks5)).toFixed(2); const inp=parseFloat(document.getElementById('input5').value).toFixed(2); document.getElementById('fb5').textContent=(inp===trueCount?'Correct':'Wrong'); }

    // Level 6
    const basicIndex = [{player:16,dealer:10,index:0}]; // 0=hit,1=stand
    function setup6(){ window.scen6 = basicIndex[Math.floor(Math.random()*basicIndex.length)]; document.getElementById('info6').textContent=`Count: ${Math.floor(Math.random()*6)-2}, Player: ${window.scen6.player}, Dealer: ${window.scen6.dealer}`; document.getElementById('input6').value=''; document.getElementById('fb6').textContent=''; }
    function check6(){ const action=document.getElementById('input6').value.trim().toLowerCase(); const correct = window.scen6.index===1?'stand':'hit'; document.getElementById('fb6').textContent=(action===correct?'Correct':'Wrong'); }

    // Level 7
    function setup7(){ setup3(); window.start7=Date.now(); document.getElementById('cards7').id='flash'; window.timerInt7=setInterval(()=>{ let t=Math.floor((Date.now()-window.start7)/1000); document.getElementById('timer7').textContent='Time: '+t+'s'; },200); }
    function check7(){ clearInterval(window.timerInt7); document.getElementById('fb7').textContent='Drill complete'; }
  </script>
</body>
</html>
